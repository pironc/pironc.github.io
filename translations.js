// Translation data for the website
const translations = {
    en: {
        // Navigation
        nav_home: "home.",
        nav_about: "about.",
        nav_contact: "contact.",

        // Home section
        home_description_1: "I'm a French FPV pilot based in <strong>Barcelona</strong>, flying both indoors and outdoors using <strong>5-inch</strong> for long range and <strong>3-inch</strong> for indoors.",
        home_description_2: "For extra cinematic or accurately zoomed-in shots, the <strong>DJI Mavic 3</strong> is my go-to drone.",
        home_description_3: "I love flying and delivering the best content in the best way possible. I also have my own fleet of gear ranging from a <strong>GoPro HERO13</strong> to the <strong>Insta360 X5</strong>.",

        // About section
        about_title: "about me.",
        about_description_1: "I fluently speak <strong>French, English and Spanish</strong> to be able to meet most of clients' needs and be able to make myself understood.",
        about_description_2: "Transitions, effects, color-grading, music-synced or simply exporting the content in different formats for a future editing team, I not only fly but properly handle the footage and deliver it in the easiest way.",

        // Contact section
        contact_title: "contact.",
        contact_description: "I'm always interested in new opportunities and collaborations. Feel free to reach out via email or social media.",
        contact_email_title: "Email",
        contact_social_title: "Social",

        // Footer
        footer_copyright: "2025 - Piron Cyprien. All rights reserved.",

        // Meta tags
        meta_title: "FPV Pilot Portfolio - Piron Cyprien",
        meta_description: "Professional FPV drone pilot based in Barcelona. Specializing in aerial cinematography for events, real estate, and commercial projects across Europe.",
        meta_keywords: "FPV pilot, drone pilot, aerial cinematography, Barcelona, Spain, Greece, Kazakhstan, France, professional drone services",

        // Open Graph
        og_title: "FPV Pilot Portfolio - Piron Cyprien",
        og_description: "Professional FPV drone pilot based in Barcelona. Specializing in aerial cinematography for events, real estate, and commercial projects across Europe.",

        // Structured Data
        sd_description: "Professional FPV drone pilot based in Barcelona, specializing in aerial cinematography for events, real estate, and commercial projects across Europe.",
        sd_job_title: "FPV Drone Pilot",
        sd_languages: ["French", "English", "Spanish"],

        // Location names
        city_athens: "Athens",
        city_kape_beach: "Kape Beach",
        city_black_canyon: "Black Canyon",
        city_astana: "Astana",
        city_barcelona: "Barcelona",
        city_narbonne: "Narbonne",
        country_greece: "Greece",
        country_kazakhstan: "Kazakhstan",
        country_spain: "Spain",
        country_france: "France"
    },
    es: {
        // Navigation
        nav_home: "inicio.",
        nav_about: "sobre m√≠.",
        nav_contact: "contacto.",

        // Home section
        home_description_1: "Soy un piloto FPV franc√©s viviendo en <strong>Barcelona</strong>, volando con drones de <strong>5 pulgadas</strong> para largo alcance y <strong>3 pulgadas</strong> para interiores.",
        home_description_2: "Para tomas cinematogr√°ficas o con zoom, el <strong>DJI Mavic 3</strong> es mi dron de referencia.",
        home_description_3: "Me encanta volar y entregar el mejor contenido de la mejor manera posible. Tambi√©n tengo mi propia flota de equipos que van desde una <strong>GoPro HERO13</strong> hasta la <strong>Insta360 X5</strong>.",

        // About section
        about_title: "sobre m√≠.",
        about_description_1: "Hablo fluidamente <strong>franc√©s, ingl√©s y espa√±ol</strong> para poder satisfacer las necesidades de la mayor√≠a de los clientes y poder hacerme entender.",
        about_description_2: "Transiciones, efectos, correcci√≥n de color, sincronizaci√≥n con m√∫sica o simplemente exportar el contenido en diferentes formatos para un equipo de edici√≥n futuro, no solo vuelo sino que manejo correctamente el metraje y lo entrego de la manera m√°s f√°cil.",

        // Contact section
        contact_title: "contacto.",
        contact_description: "Siempre estoy interesado en nuevas oportunidades y colaboraciones. No dudes en ponerte en contacto conmigo por email o redes sociales.",
        contact_email_title: "Email",
        contact_social_title: "Redes Sociales",

        // Footer
        footer_copyright: "2025 - Piron Cyprien. Todos los derechos reservados.",

        // Meta tags
        meta_title: "Portafolio Piloto FPV - Piron Cyprien",
        meta_description: "Piloto profesional de drones FPV viviendo en Barcelona. Especializado en cinematograf√≠a a√©rea para eventos, bienes ra√≠ces y proyectos comerciales en Europa.",
        meta_keywords: "piloto FPV, piloto drone, cinematograf√≠a a√©rea, Barcelona, Espa√±a, Grecia, Kazajist√°n, Francia, servicios profesionales drone",

        // Open Graph
        og_title: "Portafolio Piloto FPV - Piron Cyprien",
        og_description: "Piloto profesional de drones FPV viviendo en Barcelona. Especializado en cinematograf√≠a a√©rea para eventos, bienes ra√≠ces y proyectos comerciales en Europa.",

        // Structured Data
        sd_description: "Piloto profesional de drones FPV viviendo en Barcelona, especializado en cinematograf√≠a a√©rea para eventos, bienes ra√≠ces y proyectos comerciales en Europa.",
        sd_job_title: "Piloto de Drones FPV",
        sd_languages: ["Franc√©s", "Ingl√©s", "Espa√±ol"],

        // Location names
        city_athens: "Atenas",
        city_kape_beach: "Kape Beach",
        city_black_canyon: "Black Canyon",
        city_astana: "Astan√°",
        city_barcelona: "Barcelona",
        city_narbonne: "Narbona",
        country_greece: "Grecia",
        country_kazakhstan: "Kazajist√°n",
        country_spain: "Espa√±a",
        country_france: "Francia"
    },
    fr: {
        // Navigation
        nav_home: "accueil.",
        nav_about: "√† propos.",
        nav_contact: "contact.",

        // Home section
        home_description_1: "Pilote FPV fran√ßais bas√© √† <strong>Barcelone</strong>, volant aussi bien en int√©rieur qu'en ext√©rieur en utilisant des drones <strong>5 pouces</strong> pour longue port√©e et <strong>3 pouces</strong> pour voler en int√©rieur.",
        home_description_2: "Pour des plans cin√©matiques et/ou avec zoom, le <strong>DJI Mavic 3</strong> est mon drone de pr√©dilection.",
        home_description_3: "J'adore voler et d√©livrer le meilleur contenu de la meilleure fa√ßon possible. J'ai √©galement ma propre flotte d'√©quipements allant de la <strong>GoPro HERO13</strong> √† l'<strong>Insta360 X5</strong>.",

        // About section
        about_title: "√† propos.",
        about_description_1: "Je parle couramment le <strong>fran√ßais, l'anglais et l'espagnol</strong> pour pouvoir r√©pondre aux besoins de mes clients et me faire comprendre.",
        about_description_2: "Transitions, effets, √©talonnage des couleurs, synchronisation musicale ou simplement exportation du contenu dans diff√©rents formats pour une √©quipe de montage future, je ne vole pas seulement mais g√®re correctement le contenu et les d√©livre de la mani√®re la plus facile.",

        // Contact section
        contact_title: "contact.",
        contact_description: "Je suis toujours int√©ress√© par de nouvelles opportunit√©s et collaborations. N'h√©sitez pas √† me contacter par email ou sur les r√©seaux sociaux.",
        contact_email_title: "Email",
        contact_social_title: "R√©seaux Sociaux",

        // Footer
        footer_copyright: "2025 - Piron Cyprien. Tous droits r√©serv√©s.",

        // Meta tags
        meta_title: "Portfolio Pilote FPV - Piron Cyprien",
        meta_description: "Pilote professionnel de drones FPV bas√© √† Barcelone. Sp√©cialis√© dans la cin√©matographie a√©rienne pour √©v√©nements, immobilier et projets commerciaux en Europe.",
        meta_keywords: "pilote FPV, pilote drone, cin√©matographie a√©rienne, Barcelone, Espagne, Gr√®ce, Kazakhstan, France, services professionnels drone",

        // Open Graph
        og_title: "Portfolio Pilote FPV - Piron Cyprien",
        og_description: "Pilote professionnel de drones FPV bas√© √† Barcelone. Sp√©cialis√© dans la cin√©matographie a√©rienne pour √©v√©nements, immobilier et projets commerciaux en Europe.",

        // Structured Data
        sd_description: "Pilote professionnel de drones FPV bas√© √† Barcelone, sp√©cialis√© dans la cin√©matographie a√©rienne pour √©v√©nements, immobilier et projets commerciaux en Europe.",
        sd_job_title: "Pilote de Drones FPV",
        sd_languages: ["Fran√ßais", "Anglais", "Espagnol"],

        // Location names
        city_athens: "Ath√®nes",
        city_kape_beach: "Kape Beach",
        city_black_canyon: "Black Canyon",
        city_astana: "Astana",
        city_barcelona: "Barcelone",
        city_narbonne: "Narbonne",
        country_greece: "Gr√®ce",
        country_kazakhstan: "Kazakhstan",
        country_spain: "Espagne",
        country_france: "France"
    }
};

// Default language - will be overridden by geolocation or localStorage
let currentLanguage = 'en';

// French-speaking countries/regions for auto-detection
const frenchRegions = [
    'FR', // France
    'BE', // Belgium
    'CH', // Switzerland
    'CA', // Canada
    'LU', // Luxembourg
    'MC', // Monaco
    'SN', // Senegal
    'CI', // Ivory Coast
    'ML', // Mali
    'BF', // Burkina Faso
    'NE', // Niger
    'TG', // Togo
    'BJ', // Benin
    'GA', // Gabon
    'CG', // Republic of the Congo
    'CD', // Democratic Republic of the Congo
    'CM', // Cameroon
    'TD', // Chad
    'CF', // Central African Republic
    'GQ', // Equatorial Guinea
    'RW', // Rwanda
    'BI', // Burundi
    'DJ', // Djibouti
    'MG', // Madagascar
    'SC', // Seychelles
    'KM', // Comoros
    'MU', // Mauritius
    'RE', // Reunion (France)
    'GP', // Guadeloupe (France)
    'MQ', // Martinique (France)
    'GF', // French Guiana (France)
    'YT', // Mayotte (France)
    'NC', // New Caledonia (France)
    'PF', // French Polynesia (France)
    'VA', // Vatican City
];

// Spanish-speaking countries/regions for auto-detection
const spanishRegions = [
    'ES', // Spain
    'MX', // Mexico
    'AR', // Argentina
    'CO', // Colombia
    'PE', // Peru
    'VE', // Venezuela
    'CL', // Chile
    'EC', // Ecuador
    'GT', // Guatemala
    'CU', // Cuba
    'BO', // Bolivia
    'DO', // Dominican Republic
    'HN', // Honduras
    'PY', // Paraguay
    'SV', // El Salvador
    'NI', // Nicaragua
    'CR', // Costa Rica
    'PA', // Panama
    'UY', // Uruguay
    'GQ', // Equatorial Guinea
    'AD', // Andorra
];

// Function to detect language based on IP
async function detectLanguageByIP() {
    try {
        const response = await fetch('https://ipapi.co/json/');
        const data = await response.json();

        if (frenchRegions.includes(data.country_code)) {
            return 'fr';
        }
        if (spanishRegions.includes(data.country_code)) {
            return 'es';
        }
        return 'en';
    } catch (error) {
        console.warn('Failed to detect location, defaulting to English:', error);
        return 'en';
    }
}

// Function to get stored language preference
function getStoredLanguage() {
    return localStorage.getItem('preferred-language');
}

// Function to set language preference
function setStoredLanguage(lang) {
    localStorage.setItem('preferred-language', lang);
    currentLanguage = lang;
}

// Function to translate text
function translate(key) {
    return translations[currentLanguage][key] || translations['en'][key] || key;
}

// Function to update all translatable elements
function updateTranslations() {
    // Update text content
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (key.startsWith('html:')) {
            element.innerHTML = translate(key.substring(5));
        } else {
            element.textContent = translate(key);
        }
    });

    // Update meta tags
    document.title = translate('meta_title');
    const metaDescription = document.querySelector('meta[name="description"]');
    if (metaDescription) metaDescription.setAttribute('content', translate('meta_description'));

    const metaKeywords = document.querySelector('meta[name="keywords"]');
    if (metaKeywords) metaKeywords.setAttribute('content', translate('meta_keywords'));

    // Update Open Graph tags
    const ogTitle = document.querySelector('meta[property="og:title"]');
    if (ogTitle) ogTitle.setAttribute('content', translate('og_title'));

    const ogDescription = document.querySelector('meta[property="og:description"]');
    if (ogDescription) ogDescription.setAttribute('content', translate('og_description'));

    const twitterTitle = document.querySelector('meta[property="twitter:title"]');
    if (twitterTitle) twitterTitle.setAttribute('content', translate('og_title'));

    const twitterDescription = document.querySelector('meta[property="twitter:description"]');
    if (twitterDescription) twitterDescription.setAttribute('content', translate('og_description'));

    // Update structured data
    const structuredData = document.querySelector('script[type="application/ld+json"]');
    if (structuredData) {
        try {
            const data = JSON.parse(structuredData.textContent);
            data.description = translate('sd_description');
            data.jobTitle = translate('sd_job_title');
            data.knowsLanguage = translate('sd_languages');
            structuredData.textContent = JSON.stringify(data, null, 4);
        } catch (e) {
            console.warn('Failed to update structured data:', e);
        }
    }

    // Update HTML lang attribute
    document.documentElement.lang = currentLanguage;

    // Update language switcher
    updateLanguageSwitcher();
}

// Function to update language switcher UI
function updateLanguageSwitcher() {
    const dropdown = document.querySelector('.language-dropdown');
    if (dropdown) {
        // Update current flag display
        const currentFlag = document.getElementById('current-flag');
        if (currentFlag) {
            const flags = {
                'en': 'üá∫üá∏',
                'es': 'üá™üá∏',
                'fr': 'üá´üá∑'
            };
            currentFlag.textContent = flags[currentLanguage] || 'üá∫üá∏';
        }

        // Update active state for options
        dropdown.querySelectorAll('.lang-option').forEach(option => {
            option.classList.remove('active');
            if (option.getAttribute('data-lang') === currentLanguage) {
                option.classList.add('active');
            }
        });
    }
}

// Function to initialize i18n
async function initI18n() {
    // Check for stored preference first
    const stored = getStoredLanguage();
    if (stored && translations[stored]) {
        currentLanguage = stored;
    } else {
        // Detect based on IP
        currentLanguage = await detectLanguageByIP();
    }

    updateTranslations();
}

// Export functions for global use
window.i18n = {
    setLanguage: function(lang) {
        if (translations[lang]) {
            setStoredLanguage(lang);
            updateTranslations();
        }
    },
    getCurrentLanguage: function() {
        return currentLanguage;
    }
};
